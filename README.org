#+TITLE: xah-fly-keys layer

# The maximum height of the logo should be 200 pixels.
[[img/xah-fly-keys.png]]

# TOC links should be GitHub style anchors.
* Table of Contents                                        :TOC_4_gh:noexport:
- [[#description][Description]]
- [[#install][Install]]
  - [[#configuration][Configuration]]
- [[#key-bindings][Key bindings]]
  - [[#swap-the-leader-keys][Swap the leader keys]]

* Description

This layer adds an alternative "modal editing mode for Emacs, like vi, but
the design of key/command choice is based on command frequency statistics
and ease-of-key score. Most frequently used commands have most easy keys."
[[http://ergoemacs.org/misc/ergoemacs_vi_mode.html][xah-fly-keys]] has been developed over years of experience by Xah Lee, a long
time contributer to the Emacs community.

Gain the modal superpowers of the dark side, without succumbing to evil!

* Install
Clone this repository into `.emacs.d/private/xah-fly-keys`, or where ever you
keep your private layers.

To use this configuration layer, add it to your =~/.spacemacs=. You will need to
add =xah-fly-keys= to the existing =dotspacemacs-configuration-layers= list in this
file.  You should have the =dotspacemacs-editing-style= set to ='emacs=.

It is recommended to change some of the defaults in your =.spacemacs= file, in
order to avoid some unwanted cross-over with some features.

  - set =dotspacemacs-colorize-cursor-according-to-state nil= so that the cursor will
    reflect the =xah-fly-keys= state instead.
  - set the =dotspacemacs-leader-key= to an empty string, as having it set to ="SPC"=
    interferes with the =which-key= mappings.

** Configuration

This layer assumes a "qwerty" layout and uses that as a default.  You can configure
xah-fly-keys to behave with other keyboard layouts with the =xah-fly-keys-layout=
variable. Possible values are `qwerty', `qwerty-abnt', `qwertz', `dvorak',
`programer-dvorak', `colemak', `colemak-mod-dh', `workman'".

For example, in your layers list:

#+BEGIN_SRC elisp
(xah-fly-keys :variables xah-fly-keys-layout "dvorak")
#+END_SRC

* Key bindings

| Key Binding | Description                          |
|-------------+--------------------------------------|
| ~SPC~       | opens the xah-fly-keys leader keymap |
| ~M-m~       | opens the spacemacs commands keymap  |

See [[http://ergoemacs.org/misc/ergoemacs_vi_mode.html][xah-fly-keys]] for the modal keymap defined by Xah Lee.

** Swap the leader keys
If you'd like to have the spacemacs leader key on the space bar rather than the xah-fly-keys
menu, it is possible to swap these keys.

I tried implementing this with a config variable, but it doesn't quite work as expected.
Until that is sorted out, add this to your =dotspacemacs/user-config= to swap the leader
keys for Spacemacs and xah-fly-keys.

#+BEGIN_SRC elisp
(defun xah-fly-keys-swap-spacemacs-leader ()
      (progn
        (define-key xah-fly-key-map (kbd "SPC") 'spacemacs-cmds)
        (define-key xah-fly-key-map (kbd "M-m") 'xah-fly-leader-key-map)))

(add-hook 'xah-fly-command-mode-activate-hook 'xah-fly-keys-swap-spacemacs-leader)
#+END_SRC

You'll also need to set the =dotspacemacs-emacs-leader= key to an empty string.
It appears that sometimes the =which-key= menu will be affected by this change.
